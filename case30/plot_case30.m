clc;
clear;

x1=2.01618E-14;
x2=-2.09439510;
x3=2.09439510;
x4=0.97336634;
x5=0.97336633;
x6=0.97336633;
x7=0.00105002;
x8=-2.09334508;
x9=2.09544512;
x10=0.97229595;
x11=0.97229594;
x12=0.97229594;
x13=0.00156627;
x14=-2.09282884;
x15=2.09596137;
x16=0.97237398;
x17=0.97237396;
x18=0.97237397;
x19=0.05188490;
x20=-2.04251019;
x21=2.14627998;
x22=1.03812754;
x23=1.03812754;
x24=1.03812754;
x25=0.06056515;
x26=-2.03382995;
x27=2.15496022;
x28=1.05000000;
x29=1.05000000;
x30=1.05000000;
x31=1.59595E-16;
x32=0.00000000;
x33=0.00000000;
x34=0.00000000;
x35=0.00000000;
x36=0.00000000;
x37=0.00000000;
x38=0.00000000;
x39=0.00000000;
x40=0.00000000;
x41=0.00000000;
x42=0.00000000;
x43=3.53812248;
x44=3.53812307;
x45=3.53812244;
x46=0.53799614;
x47=0.53799621;
x48=0.53799574;
x49=0.00000000;
x50=0.00000000;
x51=0.00000000;
x52=0.00000000;
x53=0.00000000;
x54=0.00000000;
x55=0.00000000;
x56=0.00000000;
x57=0.00000000;
x58=0.14991729;
x59=0.14991750;
x60=0.14991797;
x61=0.00000000;
x62=-2.09439510;
x63=2.09439510;
x64=0.97313993;
x65=0.97317949;
x66=0.97318118;
x67=0.00102887;
x68=-2.09336623;
x69=2.09542397;
x70=0.97248104;
x71=0.97248103;
x72=0.97248104;
x73=0.09999999;
x74=0.10000002;
x75=0.09999999;
x76=0.09999999;
x77=0.10000000;
x78=0.10000001;
x79=0.99976739;
x80=0.99980805;
x81=0.99980978;
x82=-0.00062261;
x83=-2.09501773;
x84=2.09377248;
x85=0.97260051;
x86=0.97260047;
x87=0.97260050;
x88=0.00054474;
x89=-2.09385038;
x90=2.09493984;
x91=0.97146160;
x92=0.97146157;
x93=0.97146160;
x94=0.00119565;
x95=-2.09319947;
x96=2.09559075;
x97=0.97136414;
x98=0.97136411;
x99=0.97136413;
x100=0.05181318;
x101=-2.04258196;
x102=2.14620833;
x103=1.03803853;
x104=1.03803852;
x105=1.03803852;
x106=0.06054277;
x107=-2.03385237;
x108=2.15493794;
x109=1.05000000;
x110=1.05000000;
x111=1.05000000;
x112=0.00000000;
x113=0.00000000;
x114=0.00000000;
x115=0.00000000;
x116=0.00000000;
x117=0.00000000;
x118=0.00000000;
x119=0.00000000;
x120=0.00000000;
x121=0.00000000;
x122=0.00000000;
x123=0.00000000;
x124=3.56726352;
x125=3.56726289;
x126=3.56726365;
x127=0.60935399;
x128=0.60935329;
x129=0.60935457;
x130=0.00000000;
x131=0.00000000;
x132=0.00000000;
x133=0.00000000;
x134=0.00000000;
x135=0.00000000;
x136=0.00000000;
x137=0.00000000;
x138=0.00000000;
x139=0.15883345;
x140=0.15883376;
x141=0.15883253;
x142=-0.00062261;
x143=-2.09501773;
x144=2.09377248;
x145=1.00501374;
x146=1.00488992;
x147=1.00515792;
x148=0.00052355;
x149=-2.09387156;
x150=2.09491865;
x151=0.97164686;
x152=0.97164682;
x153=0.97164685;
x154=0.09999997;
x155=0.10000007;
x156=0.09999995;
x157=0.09999993;
x158=0.10000001;
x159=0.10000006;
x160=1.03332635;
x161=1.03319908;
x162=1.03347460;
x163=0.00123491;
x164=-2.09316020;
x165=2.09563001;
x166=0.97150629;
x167=0.97150627;
x168=0.97150628;
x169=0.00094228;
x170=-2.09345283;
x171=2.09533738;
x172=0.97078084;
x173=0.97078082;
x174=0.97078083;
x175=0.00090716;
x176=-2.09348795;
x177=2.09530226;
x178=0.97071124;
x179=0.97071122;
x180=0.97071124;
x181=0.00087231;
x182=-2.09352280;
x183=2.09526741;
x184=0.97064314;
x185=0.97064312;
x186=0.97064314;
x187=0.00085279;
x188=-2.09354232;
x189=2.09524789;
x190=0.97060637;
x191=0.97060635;
x192=0.97060636;
x193=0.00071954;
x194=-2.09367557;
x195=2.09511464;
x196=0.97019466;
x197=0.97019464;
x198=0.97019465;
x199=0.00070991;
x200=-2.09368520;
x201=2.09510501;
x202=0.97012523;
x203=0.97012520;
x204=0.97012522;
x205=0.00069456;
x206=-2.09370055;
x207=2.09508966;
x208=0.97009388;
x209=0.97009386;
x210=0.97009388;
x211=0.00051585;
x212=-2.09387926;
x213=2.09491095;
x214=0.96974739;
x215=0.96974737;
x216=0.96974738;
x217=0.00048513;
x218=-2.09390998;
x219=2.09488022;
x220=0.96968468;
x221=0.96968466;
x222=0.96968467;
x223=0.00047396;
x224=-2.09392115;
x225=2.09486906;
x226=0.96965878;
x227=0.96965876;
x228=0.96965877;
x229=0.00037345;
x230=-2.09402166;
x231=2.09476855;
x232=0.96942557;
x233=0.96942554;
x234=0.96942556;
x235=0.00034414;
x236=-2.09405097;
x237=2.09473924;
x238=0.96935330;
x239=0.96935328;
x240=0.96935330;
x241=0.00033019;
x242=-2.09406491;
x243=2.09472529;
x244=0.96931241;
x245=0.96931238;
x246=0.96931240;
x247=0.00033154;
x248=-2.09406357;
x249=2.09472663;
x250=0.96933692;
x251=0.96933690;
x252=0.96933692;
x253=0.00030637;
x254=-2.09408874;
x255=2.09470147;
x256=0.96928714;
x257=0.96928712;
x258=0.96928714;



Agams=[x1;x2;x3;x7;x8;x9;x13;x14;x15;x19;x20;x21;x25;x26;x27;x67;x68;x69;x61;x62;x63; ...
       x82;x83;x84;x88;x89;x90;x94;x95;x96;x100;x101;x102;x106;x107;x108;x148;x149;x150;x142;x143;x144; ...
       x163;x164;x165;x169;x170;x171;x175;x176;x177;x181;x182;x183;x187;x188;x189;x193;x194;x195;x199;x200;x201;x205;x206;x207;x211;x212;x213;x217;x218;x219; ...
       x223;x224;x225;x229;x230;x231;x235;x236;x237;x241;x242;x243;x247;x248;x249;x253;x254;x255];

Vgams=[
x4
x5
x6
x10
x11
x12
x16
x17
x18
x22
x23
x24
x28
x29
x30
x70
x71
x72
x64
x65
x66
% No.2
x85
x86
x87
x91
x92
x93
x97
x98
x99
x103
x104
x105
x109
x110
x111
x151
x152
x153
x145
x146
x147

x166
x167
x168
x172
x173
x174
x178
x179
x180
x184
x185
x186
x190
x191
x192
x196
x197
x198
x202
x203
x204
x208
x209
x210
x214
x215
x216
x220
x221
x222
x226
x227
x228
x232
x233
x234
x238
x239
x240
x244
x245
x246
x250
x251
x252
x256
x257
x258
];
Vsdp=[0.973382251687372
   0.973378738851728
   0.973359556068670
   0.972316275396668
   0.972308016402785
   0.972287745639363
   0.972393520933116
   0.972388782865630
   0.972370659880012
   1.038129624898512
   1.038128731915497
   1.038126713444630
   1.049999926935179
   1.049999926964255
   1.049999926956634
   0.972502969283643
   0.972492819554993
   0.972471524101198
   0.973736007953588
   0.973739978526514
   0.973728230438287
   0.972581894929856
   0.972584500254791
   0.972572613784434
   0.971496544640915
   0.971497610948171
   0.971485947194750
   0.971375842062129
   0.971376778242158
   0.971364770720816
   1.038042222207751
   1.038042330099233
   1.038041143030042
   1.049999928036044
   1.049999928031533
   1.049999928076925
   0.971682051022121
   0.971682810340993
   0.971670980078671
   1.005368845574542
   1.005364148294038
   1.005347889541959
   0.971534114632411
   0.971532212142782
   0.971517142198163
   0.970833093012851
   0.970831189439219
   0.970816108292076
   0.970763497538531
   0.970761593692382
   0.970746511375253
   0.970695400520027
   0.970693496395018
   0.970678413010941
   0.970658626367444
   0.970656721991523
   0.970641638149999
   0.970271348898379
   0.970269445121788
   0.970254354941302
   0.970214126285730
   0.970212222235856
   0.970197131395996
   0.970182787935752
   0.970180883886022
   0.970165792596568
   0.969824104724718
   0.969822201171037
   0.969807103144297
   0.969761399420097
   0.969759495713495
   0.969744396696874
   0.969735503104382
   0.969733599342729
   0.969718499973680
   0.969502304116605
   0.969500400789493
   0.969485297084593
   0.969430046369447
   0.969428142924394
   0.969413038128093
   0.969389152214128
   0.969387248558139
   0.969372143181681
   0.969413668688652
   0.969411765427349
   0.969396660224264
   0.969363892134455
   0.969361988845992
   0.969346882791952
];

Asdp =[            0
  -2.094395102393195
   2.094395102393195
   0.001046997687342
  -2.093342229878916
   2.095442380816891
   0.001561020151124
  -2.092832390785138
   2.095957753155470
   0.051887126657580
  -2.042501455923839
   2.146305468372727
   0.060567838592098
  -2.033820503629485
   2.154988854787121
   0.001025241625427
  -2.093361652104166
   2.095420104304561
                   0
  -2.094395102393195
   2.094395102393195
  -0.000592645975554
  -2.094999371920682
   2.093802778390367
   0.000518722904757
  -2.093886384426626
   2.094914310849818
   0.001193333799213
  -2.093211153649158
   2.095589278146182
   0.051813145659666
  -2.042592652699923
   2.146214886643957
   0.060545530809322
  -2.033860279734473
   2.154948007687836
   0.000497438673065
  -2.093907290435361
   2.094892940378815
  -0.000592645975554
  -2.094999371920682
   2.093802778390367
   0.001214319800845
  -2.093184627648768
   2.095610651969933
   0.000888242241961
  -2.093510705408825
   2.095284565291256
   0.000853123608669
  -2.093545824126149
   2.095249445424053
   0.000818276243631
  -2.093580671532682
   2.095214596826545
   0.000798756094819
  -2.093600191836524
   2.095195075859781
   0.000631830652403
  -2.093767118144715
   2.095028145207058
   0.000605334601777
  -2.093793614370278
   2.095001648050180
   0.000589988637011
  -2.093808960463657
   2.094986301525485
   0.000428165471756
  -2.093970783698053
   2.094824473785893
   0.000397447788168
  -2.094001501524497
   2.094793755041174
   0.000386284928961
  -2.094012664486010
   2.094782591722907
   0.000285790691316
  -2.094113158777786
   2.094682094739870
   0.000256482297517
  -2.094142467268735
   2.094652785413764
   0.000242541550553
  -2.094156408112018
   2.094638844070958
   0.000243882140748
  -2.094155067542359
   2.094640184843947
   0.000218724367740
  -2.094180225395275
   2.094615026247879];

Pg_gams=[1.59595E-16;0;0;3.53812248;3.53812307;3.53812244;0.00000000;0;0;3.56726352;3.56726289;3.56726365];
Qg_gams=[0.53799614;0.53799621;0.53799574;0.14991729;0.14991750;0.14991797;0.60935399;0.60935329;0.60935457;0.15883345;0.15883376;0.15883253];
Pg_sdp=[0.000000012976282
   0.000000012976294
   0.000000012976607
   3.537956491619335
   3.538039862266194
   3.538645549776500
   0.000000012985455
   0.000000012985460
   0.000000012985575
   3.567074640592144
   3.567060096144688
   3.567342166167327];
Qg_sdp=[0.536602464885645
   0.537487715357547
   0.537091745077196
   0.149517684806440
   0.149216185004445
   0.149388406847635
   0.608399347379443
   0.608798873045860
   0.608618600542449
   0.158107881845919
   0.157969524430575
   0.158075402741553];

V_MAE=max(abs(Vsdp-Vgams))
Pg_MAE=max(abs(Pg_sdp-Pg_gams))
Qg_MAE=max(abs(Qg_sdp-Qg_gams))
V_RMSE=sqrt((sum(abs(Vsdp-Vgams).^2))/90)
Pg_RMSE=sqrt((sum(abs(Pg_sdp-Pg_gams).^2))/90)
Qg_RMSE=sqrt((sum(abs(Qg_sdp-Qg_gams).^2))/90)


figure(1)
subplot(2,1,1) 
plot(1:90,Vgams,'-*',1:90,Vsdp,'-o')

xlabel('Bus');
ylabel('Voltage Magnitude/pu');
xticks([2 5 8 11 14 17 20 23 26 29 32 35 38 41 44 47 50 53 56 59 62 65 68 71 74 77 80 83 86 89])
set(gca, 'xticklabel',{'1';'2';'3';'4';'5';'6';'7';'8';'9';'10';'11';'12';'13';'14';'15';'16';'17';'18';'19';'20';'21';'22';'23';'24';'25';'26';'27';'28';'29';'30'});

set(gca,'xticklabelRotation',0);

legend('V-nonconvex','V-sdp');

subplot(2,1,2) 
plot(1:90,Agams,'-*',1:90,Asdp,'-o')
xlabel('Bus');
ylabel('Phase Angle/rad');
xticks([2 5 8 11 14 17 20 23 26 29 32 35 38 41 44 47 50 53 56 59 62 65 68 71 74 77 80 83 86 89])
set(gca, 'xticklabel',{'1';'2';'3';'4';'5';'6';'7';'8';'9';'10';'11';'12';'13';'14';'15';'16';'17';'18';'19';'20';'21';'22';'23';'24';'25';'26';'27';'28';'29';'30'});

set(gca,'xticklabelRotation',0);

legend('\theta-nonconvex','\theta-sdp');
