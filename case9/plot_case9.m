clc;
clear;

Pg_gams=[-9.9859E-11;-9.9859E-11;-9.9859E-11;4.73161089;4.13267622;3.46165609];
Qg_gams=[0.52827109;0.48720347;0.53311712;0.35445841;0.30011810;0.12746854];
Pg_sdp=[0.000000025823582
   0.000000025774899
   0.000000025782290
   4.734599833526850
   4.128539268057796
   3.462791522107685];
Qg_sdp=[0.524312427714536
   0.491002943414831
   0.533810502898863
   0.361008640196760
   0.297184230180827
   0.123309310740185];

Vgams=[0.973590480000000
   0.975264340000000
   0.975269290000000
   0.972334130000000
   0.974323400000000
   0.974169580000000
   0.972720800000000
   0.974485720000000
   0.974407250000000
   1.032422190000000
   1.040660650000000
   1.038301130000000
   1.050000000000000
   1.050000000000000
   1.050000000000000
   0.972523900000000
   0.974505130000000
   0.974352620000000
   1.006740890000000
   1.008318590000000
   1.008339080000000
   0.997187140000000
   1.011282060000000
   0.990289100000000
];
Vsdp=[
   0.973308557992243
   0.975331969043841
   0.975495957288597
   0.972068264736252
   0.974385682609591
   0.974384791405029
   0.972466469301271
   0.974541995455855
   0.974616643478985
   1.032398102372819
   1.040662579181910
   1.038329511603629
   1.049999878394102
   1.049999858732481
   1.049999851710050
   0.972253706389206
   0.974570410990762
   0.974569150370082
   1.006230917913457
   1.008178715602220
   1.008364587830370
   0.997203548393137
   1.011290659574057
   0.990263915855321
];

V_MAE=max(abs(Vsdp-Vgams))
Pg_MAE=max(abs(Pg_sdp-Pg_gams))
Qg_MAE=max(abs(Qg_sdp-Qg_gams))

V_RMSE=sqrt((sum(abs(Vsdp-Vgams).^2))/24)
Pg_RMSE=sqrt((sum(abs(Pg_sdp-Pg_gams).^2))/24)
Qg_RMSE=sqrt((sum(abs(Qg_sdp-Qg_gams).^2))/24)


Agams=[0.000000000000000
  -2.094395100000000
   2.094395100000000
   0.000920620000000
  -2.093558460000000
   2.095527190000000
   0.001638270000000
  -2.092977000000000
   2.096010420000000
   0.049162020000000
  -2.046036780000000
   2.147386540000000
   0.061176790000000
  -2.036358870000000
   2.153354260000000
   0.000898730000000
  -2.093583500000000
   2.095510840000000
   0.000000000000000
  -2.094395100000000
   2.094395100000000
   0.050267410000000
  -2.071622450000000
   0.027182250000000];
Asdp =[             0
  -2.094395102393195
   2.094395102393195
   0.000906520972808
  -2.093532371533649
   2.095516365253278
   0.001619357075077
  -2.092955394677718
   2.096009041472390
   0.048915287588243
  -2.045918443405776
   2.147529411246381
   0.060900476752435
  -2.036235059734094
   2.153520486610626
   0.000885280544173
  -2.093552714156478
   2.095494663833599
                   0
  -2.094395102393195
   2.094395102393195
   0.049990452822988
  -2.071485194411318
   0.026934445412128];
figure(1)
subplot(2,1,1) 
plot(1:24,Vgams,'-*',1:24,Vsdp,'-o')
xlabel('Bus');
ylabel('Voltage Magnitude/p.u.');
xticks([2 5 8 11 14 17 20 22.5 24])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7';'V8';'V9'});
legend('V-nonconvex','V-sdp');

subplot(2,1,2) 
plot(1:24,Agams,'-*',1:24,Asdp,'-o')
xlabel('Bus');
ylabel('Phase Angle/rad');
xticks([2 5 8 11 14 17 20 22.5 24])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7';'V8';'V9'});

legend('\theta-nonconvex','\theta-sdp');
