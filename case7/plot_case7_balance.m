clc;
clear;

Pg=[0.000000000813148
   0.000000000813148
   0.000000000813155
   3.461310416663661
   3.461321399073950
   3.461529286149544];
Qg=[0.512426717296557
   0.512725651844833
   0.512589967325608
   0.147624596539329
   0.147520857478242
   0.147583417860918];
Pg_DGrevised=[0.000000000017769
   0.000000000017769
   0.000000000017769
   3.461387003968618
   3.461387003129168
   3.461387003828582];
Qg_DGrevised=[0.512438026751260
   0.512438026982613
   0.512438026775424
   0.147719007063974
   0.147719006861699
   0.147719006927239];

V=[0.975286985280973
   0.975286986437617
   0.975279759009709
   0.974211081635941
   0.974209653057838
   0.974202170811456
   0.974435412470337
   0.974434745472654
   0.974427714482933
   1.038331021095903
   1.038330863191435
   1.038330113525964
   1.049999809231094
   1.049999808905264
   1.049999808904442
   0.974396240345239
   0.974394306894243
   0.974386548939084
   1.004635854279878
   1.004637598022469
   1.004641721546119
];

VDGrevised=[0.975281417774214
   0.975281417790663
   0.975281417777491
   0.974204727325763
   0.974204727340611
   0.974204727330698
   0.974429768910420
   0.974429768925080
   0.974429768914191
   1.038330519439645
   1.038330519444047
   1.038330519442280
   1.049999999892474
   1.049999999893602
   1.049999999893498
   0.974389458153963
   0.974389458170241
   0.974389458159312
   1.004529427773275
   1.004529427813747
   1.004529427743569
];

V_MAE=max(abs(VDGrevised-V))
Pg_MAE=max(abs(Pg_DGrevised-Pg))
Qg_MAE=max(abs(Qg_DGrevised-Qg))

V_RMSE=sqrt((sum(abs(VDGrevised-V).^2))/21)
Pg_RMSE=sqrt((sum(abs(Pg_DGrevised-Pg).^2))/21)
Qg_RMSE=sqrt((sum(abs(Qg_DGrevised-Qg).^2))/21)


A=[0
  -2.094395102393195
   2.094395102393195
   0.000965709940959
  -2.093427646074384
   2.095360927657106
   0.001527929936258
  -2.092866262328042
   2.095923532270472
   0.050354130111800
  -2.044039307668539
   2.144756033973549
   0.058870656082431
  -2.035522736734546
   2.153273347657373
   0.000944478581733
  -2.093448247768182
   2.095339553631940
                   0
  -2.094395102393195
   2.094395102393195];

ADGrevised =[ 0
  -2.094395102393195
   2.094395102393195
   0.000966033376655
  -2.093429069014951
   2.095361135771275
   0.001528033750525
  -2.092867068643588
   2.095923136143615
   0.050353264099261
  -2.044041838307800
   2.144748366489214
   0.058869696763735
  -2.035525405644585
   2.153264799154678
   0.000944964240073
  -2.093450138150865
   2.095340066635150
                   0
  -2.094395102393195
   2.094395102393195];

figure(1)
subplot(2,1,1) 
plot(1:21,V,'-*',1:21,VDGrevised,'-o')
xlabel('Bus');
ylabel('Voltage Magnitude/p.u.');
xticks([2 5 8 11 14 17 20])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7'});
legend('DG-seq','DG-independent');

subplot(2,1,2)
plot(1:21,A,'-*',1:21,ADGrevised,'-o')
xlabel('Bus');
ylabel('Phase Angle/rad');
xticks([2 5 8 11 14 17 20])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7'});

legend('DG-seq','DG-independent');
