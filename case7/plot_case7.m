clc;
clear;

Pg_gams=[0;0;0;3.46138662;3.46138664;3.46138774];
Qg_gams=[0.51243648;0.51243180;0.51243851;0.14772101;0.14772463;0.14771856];
Pg_sdp=[0;0;0;3.46131042;3.46132140;3.46152929];
Qg_sdp=[0.51242672;0.51272565;0.51258997;0.14762460;0.14752086;0.14758342];


Vgams=[0.97528153
0.97528115
0.97528141
0.97420483
0.97420448
0.97420472
0.97442987
0.97442952
0.97442976
1.03833053
1.03833049
1.03833052
1.05000000
1.05000000
1.05000000
0.97438956
0.97438921
0.97438945
1.00444638
1.00444745
1.00445986
];
Vsdp=[
0.97528699
0.97528699
0.97527976
0.97421108
0.97420965
0.97420217
0.97443541
0.97443475
0.97442771
1.03833102
1.03833086
1.03833011
1.05000000
1.05000000
1.05000000
0.97439624
0.97439430
0.97438655
1.00463585
1.00463760
1.00464172
];

V_MAE=max(abs(Vsdp-Vgams))
Pg_MAE=max(abs(Pg_sdp-Pg_gams))
Qg_MAE=max(abs(Qg_sdp-Qg_gams))

V_RMSE=sqrt((sum(abs(Vsdp-Vgams).^2))/21)
Pg_RMSE=sqrt((sum(abs(Pg_sdp-Pg_gams).^2))/21)
Qg_RMSE=sqrt((sum(abs(Qg_sdp-Qg_gams).^2))/21)


Agams=[1.58819E-22;-2.09439510;2.09439510;0.00096603;-2.09342908;2.09536113;0.00152803;-2.09286708;2.09592313;0.05035322;-2.04404194;2.14474832;0.05886965;-2.03552552;2.15326475;0.00094496;-2.09345015;2.09534006;0.00000000;-2.09439510;2.09439510];
Asdp =[            0
  -2.094395102393195
   2.094395102393195
   0.000965709940959
  -2.093427646074384
   2.095360927657106
   0.001527929936258
  -2.092866262328042
   2.095923532270472
   0.050354130111800
  -2.044039307668539
   2.144756033973549
   0.058870656082431
  -2.035522736734546
   2.153273347657373
   0.000944478581733
  -2.093448247768182
   2.095339553631940
   0
  -2.094395102393195
   2.094395102393195];
figure(1)
subplot(2,1,1) 
plot(1:21,Vgams,'-*',1:21,Vsdp,'-o')
xlabel('Bus');
ylabel('Voltage Magnitude/p.u.');
xticks([2 5 8 11 14 17 20])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7'});
legend('V-nonconvex','V-sdp');

subplot(2,1,2) 
plot(1:21,Agams,'-*',1:21,Asdp,'-o')
xlabel('Bus');
ylabel('Phase Angle/rad');
xticks([2 5 8 11 14 17 20])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7'});

legend('\theta-nonconvex','\theta-sdp');
