clc;
clear;

Pg=[0.000000021541884
   0.000000020358665
   0.000000021069469
   4.545707701143762
   2.618081775896417
   3.952614971533101];
Qg=[1.131423810176489
   0.304671416665859
   1.696757760040476
   0.495538991704302
   0.276398623087872
  -0.135850565791829];
Pg_DGrevised=[0.000000000010613
   0.000000000010254
   0.000000000010505
   4.554176169780670
   2.649860534036018
   3.892659251010655];
Qg_DGrevised=[1.255578509877221
   0.478828132774485
   1.290129230129260
   0.318199264331492
   0.130237302077295
   0.280600177241219];




V=[0.954774136085758
   0.992931413098221
   0.959075427022291
   0.951039071508048
   0.994274997787596
   0.956341876849586
   0.950000167674808
   0.994872029038766
   0.954501190166286
   1.033005083632909
   1.044515130044117
   1.035354288954203
   1.049999960607167
   1.049999839711560
   1.049999915038400
   0.951229060693570
   0.994458524497528
   0.956526605732351
   0.996560224216982
   1.012586593944881
   0.997986923903236
];

VDGrevised=[
0.955584321460310
   0.985368422363780
   0.962611939433929
   0.953198764004684
   0.984872819759385
   0.960585740894158
   0.952874262842586
   0.984370150422697
   0.959103301594713
   1.033774997735829
   1.041677982684645
   1.037261303131954
   1.049999999959738
   1.049999999899914
   1.049999999950973
   0.953367925439315
   0.985078394840986
   0.960779619319318
   0.996780983362664
   1.009135518418522
   0.999196871318075
];

V_MAE=max(abs(VDGrevised-V))
Pg_MAE=max(abs(Pg_DGrevised-Pg))
Qg_MAE=max(abs(Qg_DGrevised-Qg))

V_RMSE=sqrt((sum(abs(VDGrevised-V).^2))/21)
Pg_RMSE=sqrt((sum(abs(Pg_DGrevised-Pg).^2))/21)
Qg_RMSE=sqrt((sum(abs(Qg_DGrevised-Qg).^2))/21)


A=[0
  -2.094395102393195
   2.094395102393195
   0.001394621557053
  -2.094865358145457
   2.099817250356422
   0.001091053136831
  -2.094483858218262
   2.102752250854671
   0.071643772498465
  -2.065635385273323
   2.167097480566208
   0.085226492791752
  -2.061202890370768
   2.174969060436453
   0.001378414754227
  -2.094887660376804
   2.099791798092586
                   0
  -2.094395102393195
   2.094395102393195];

ADGrevised =[    0
  -2.094395102393195
   2.094395102393195
   0.002857322336570
  -2.093693482930231
   2.096845599895362
   0.003209868992788
  -2.093150098412697
   2.098949692869375
   0.066640075830832
  -2.051712120748578
   2.155403554823616
   0.077852449953989
  -2.045987761590464
   2.164105461538670
   0.002836310201030
  -2.093720044743691
   2.096827248795150
                   0
  -2.094395102393195
   2.094395102393195];
figure(1)
subplot(2,1,1) 
plot(1:21,V,'-*',1:21,VDGrevised,'-o')
xlabel('Bus');
ylabel('Voltage Magnitude/p.u.');
xticks([2 5 8 11 14 17 20])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7'});
legend('DG-seq','DG-independent');

subplot(2,1,2)
plot(1:21,A,'-*',1:21,ADGrevised,'-o')
xlabel('Bus');
ylabel('Phase Angle/rad');
xticks([2 5 8 11 14 17 20])
set(gca, 'xticklabel',{'V1';'V2';'V3';'V4';'V5';'V6';'V7'});

legend('DG-seq','DG-independent');
